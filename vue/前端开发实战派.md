# 前端开发实战派

电子书：https://ebook.ruidoc.cn/

Vue3 备忘录：https://github.com/ruidoc/vue3-memo
Vue3 + NodeJS 仿稀土掘金：https://github.com/ruidoc/jueblog-combat

# 第4章 Vue.js 3 的基础与核心

## 4.1 初始 Vue.js 3

该文件以.vue 为后缀，因此被称为单文件组件（简称SFC）。

## 4.2 Vue.js 的基本概念

需要注意的是，Vue.js 将methods属性下所有方法内的this都指向组件实例，以确保this在任意情况下的指向都是正确的。因此，在methods属性下定义方法时不可以使用箭头函数。

### 4.2.4 计算属性与监听器

#### 2、监听器

监听器默认是浅层监听，即只有在状态被重新赋值时才会被监听到。如果监听一个数组，数组项被修改，那么监听器默认是监听不到的。

为了解决这个问题，监听器提供了深层监听，示例如下：

```vue
export default {
  data() {
    return {
      lists: [
        { name: '朱元璋' },
        { name: '朱标' },
      ]
    }
  },
  watch: {
    lists: {
      handler(val) {
        console.log(val); // list 数组
      },
      deep: true,
    }
  }
}
```

由于深层监听的开销很大，因此优先使用浅层监听，只有在监听复杂数据时才使用深层监听。

### 4.3.2 组件的自定义事件

Vue.js 的自定义事件由子组件触发，由父组件监听，从而实现自下而上的事件响应。

## 4.4 Vue.js 3的核心：组合式 API

### 4.4.1 选项式 API 和组合式 API

在Vue.js中，有两种主要的API来组织和管理组件的逻辑：Options API和Composition API。

### Options API

Options API 是Vue.js早期版本中最常用的 API。它基于选项对象，并将组件的不同功能划分为选项。每个选项都有特定的含义，如 `data`、`methods`、`computed`、`watch` 等。使用 Options API 编写的代码结构清晰，易于理解，适用于小到中型的应用程序。

#### 优点：
1. 结构清晰：Options API 将组件的不同功能划分为选项，使得代码结构清晰易于理解。
2. 易于上手：Options API 对于初学者来说比较容易理解和使用。

#### 缺点：
1. 代码复用性较差：Options API 下，逻辑复用需要通过 mixins 和继承等方式实现，可能会导致代码冗余和混乱。
2. 逻辑关联性较强：Options API 下，不同功能的逻辑可能相互交织在一起，导致组件逻辑关联性较强，不易维护。

### Composition API

Composition API 是Vue.js 3.0版本引入的一种新的 API。它基于函数组合，并将组件的逻辑划分为多个功能单元，每个功能单元都是一个独立的函数。通过 `setup` 函数，可以将这些功能单元组合成一个逻辑整体。Composition API 提供了更灵活的方式来组织组件的逻辑，可以更好地处理大型和复杂的应用程序。

#### 优点：
1. 代码复用性强：Composition API 提供了更灵活的代码组织方式，可以更容易地实现逻辑的复用。
2. 逻辑分离性强：Composition API 下，不同功能的逻辑被划分为独立的函数，使得组件的逻辑分离性更强，易于维护和测试。
3. 更好的类型推导：Composition API 下，可以更好地利用 TypeScript 等静态类型检查工具进行类型推导。

#### 缺点：
1. 学习曲线较陡：对于初学者来说，Composition API 的学习曲线可能较陡，需要花费一定的时间来适应和掌握。
2. 过度抽象可能导致混乱：使用 Composition API 时，过度抽象可能会导致代码复杂度增加，使得代码难以理解和维护。

总的来说，Options API 适用于小型到中型的应用程序，结构清晰易于理解；而 Composition API 则适用于大型和复杂的应用程序，提供了更灵活的代码组织方式和更好的代码复用性。在选择使用哪种 API 时，可以根据项目的规模和复杂度进行考虑和权衡。

### 4.4.2 理解响应式状态

**1、reactive()函数**

**2、ref()函数**

reactive()函数的局限性决定了难以被广泛应用。为了解决问题，Vue.js 3 提供了更好的替代方案，即ref()函数。使用ref()函数可以创建任意类型的响应式状态。



需要注意的是，在访问响应式引用的值时（**js代码中**），需要使用 `.value` 属性。这是因为 `ref()` 函数返回的是一个包含原始值的对象，而不是原始值本身。所以在代码中，我们使用 `count.value` 来访问和修改 `count` 的值。

在模板中不需要使用 `.value` 的方式来访问 `ref()` 函数定义的响应式值。在 Vue.js 3 中，模板编译器会自动将响应式引用（ref）的值解包，因此你可以直接在模板中使用响应式引用而无需额外的 `.value`。



## 4.5 Vue 全家桶指南

### 4.5.2 状态管理-Pinia

Pinia 的发音为 /piːnjʌ/，与英语中的 "peenya" 相似，它来源于西班牙语中的 "piña"，意为菠萝。

Pinia 对 Vue 2 和 Vue 3 都有效

**1、使用状态管理**

在 Vue.js 3中，官方推荐的是一个全新的解决方案，即Pinia。Pinia支持 Composition API ，并且对服务端渲染有更好的支持。

# 第5章 使用 Vue.js 3 编写一个备忘录应用

## 5.3 开发：业务功能编码

### 5.3.2 编写用户 Store

提示：因为在Pinia仓库中存储的所有状态在刷新浏览器时都会被销毁重置，所以需要将这些状态存储在localStorage中避免数据丢失。

### 5.3.7 开发编辑器组件

编辑备忘录内容需要一个富文本编辑器，可以借助开源第三方编辑器 wangEditor。