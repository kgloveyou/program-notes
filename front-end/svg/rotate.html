<!DOCTYPE html>
<html>

<head>
  <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.0/dist/svg.min.js"></script>
</head>

<body>
  <div id="drawing"></div>

  <script>
    // 创建 SVG 画布
    var draw = SVG().addTo('body').size(500, 500);

    // 创建 polyline
    var polyline = draw.polyline([[100, 100], [200, 200], [300, 100]])
      .fill('none')
      .stroke({ color: 'black', width: 2 });

    // 选择旋转的端点
    var rotationPoint = polyline.node.points.getItem(0);

    // 设置初始旋转角度
    var initialAngle = 0;

    // 初始化角度增量
    var angleDelta = 0;

    // 监听鼠标按下事件
    polyline.on('mousedown', function (event) {
      event.preventDefault();

      // 计算鼠标位置相对于端点的角度
      var startX = event.clientX;
      var startY = event.clientY;
      var startAngle = Math.atan2(startY - rotationPoint.y, startX - rotationPoint.x);

      // 监听鼠标移动事件
      draw.on('mousemove', function (event) {
        event.preventDefault();

        // 计算当前鼠标位置相对于端点的角度
        var currentX = event.clientX;
        var currentY = event.clientY;
        var currentAngle = Math.atan2(currentY - rotationPoint.y, currentX - rotationPoint.x);

        // 计算旋转角度增量
        angleDelta = currentAngle - startAngle;

        // 计算总旋转角度
        var totalAngle = initialAngle + angleDelta;

        // 应用旋转变换
        polyline.transform({ rotation: totalAngle * 180 / Math.PI, cx: rotationPoint.x, cy: rotationPoint.y });
      });

      // 监听鼠标释放事件
      draw.on('mouseup', function () {
        // 移除事件监听
        draw.off('mousemove');
        draw.off('mouseup');

        // 更新初始角度
        initialAngle += angleDelta;
      });
    });


  </script>
</body>

</html>