# [图灵程序设计丛书].Node与Express开发

# 第3章 省时省力的Express

## 3.2 旅行社网站

```js
app.get('/', function(req, res){
    res.type('text/plain');
    res.send('Meadowlark Travel');
});
app.get('/about', function(req, res){
    res.type('text/plain');
    res.send('About Meadowlark Travel');
});
// 定制 404 页面
app.use(function(req, res, next){
    res.type('text/plain');
    res.status(404);
    res.send('404 - Not Found');
});
```

app.get 是我们添加路由的方法。 在 Express 文档中写的是 app.VERB。 这并不意味着存在一个叫 VERB 的方法， 它是用来指代 HTTP 动词的（最常见的是“get” 和“post”）。 这个方法有两个参数： 一个路径和一个函数。  

路由就是由这个路径定义的。 app.VERB 帮我们做了很多工作： 它默认忽略了大小写或反斜杠， 并且在进行匹配时也不考虑查询字符串。 所以针对关于页面的路由对于 /about、/About、 /about/、 /about?foo=bar、 /about/?foo=bar 等路径都适用。  

### 4.3.1 如果你要自己动手  

```.gitignore
node_modules
*~
.DS_Store
```

.gitignore 文件中的条目也适用于子目录。 所以如果你把 *~ 放在项目根目录下的 .gitignore 文件里， 那么子目录里的所有这种备份文件都会被忽略。  



目前有三种流行的（无头浏览器）解决方案： Selenium、PhantomJS 和 Zombie。  

## 5.11 用Grunt实现自动化  

一个叫 Grunt 的工具可以很容易地实现这些任务的自动化。   

## 5.12 持续集成  

目前 Node 中最流行的 CI 服务器是 Travis CI（http://about.travis-ci.org/docs/user/getting-started）。  

# 第 6 章  请求和响应对象  

## 6.1 URL的组成部分  

- 端口  

  如果省略端口值， 那么默认 80 端口负责 HTTP 传输， 443 端口负责 HTTPS 传输。 如果不使用 80 和 443 端口， 就需要一个大于 10231 的端口号。  

- 查询字符串  

  查询字符串是一种键值对集合， 是可选的。 它以问号（?） 开头， 键值对则以与号（&）分隔开。   所有的名称和值都必须是 URL 编码的。 对此， JavaScript 提供了一个嵌入式的函数 encodeURIComponent 来处理。   

- 信息片段  

  信息片段（或散列） 被严格限制在浏览器中使用， 不会传递到服务器。 用它控制单页应用或 AJAX 富应用越来越普遍。 最初， 信息片段只是用来让浏览器展现文档中通过锚点标记（<a id="chapter06">） 指定的部分。  

## 6.4 响应报头  

响应报头还经常会包含一些关于服务器的信息， 一般会指出服务器的类型， 有时甚至会包含操作系统的详细信息。 返回服务器信息
存在一个问题， 那就是它会给黑客一个可乘之机， 从而使站点陷入危险。 非常重视安全的服务器经常忽略此信息， 甚至提供虚假信息。 禁用 Express 的 X-Powered-By 头信息很简单：

```js
app.disable('x-powered-by');  
```

## 6.8 请求对象  

请求对象（通常传递到回调方法， 这意味着你可以随意命名， 通常命名为 req 或 request）  的生命周期始于 Node 的一个核心对象 http.IncomingMessage 的实例。 Express 添加了一些附加功能。 我们来看看请求对象中最有用的属性和方法（除了来自 Node 的 req.headers 和req.url， 所有这些方法都由 Express 添加）。  

- req.secure
  一个简便属性， 如果连接是安全的， 将返回 true。 等同于 req.protocol==='https'。  

## 6.9 响应对象  

响应对象（通常传递到回调方法， 这意味着你可以随意命名它， 通常命名为 res、 resp 或response） 的生命周期始于 Node 核心对象 http.ServerResponse 的实例。 Express 添加了一些附加功能。 我们来看看响应对象中最有用的属性和方法（所有这些方法都是由 Express添加的）。  

- res.redirect([status],url)  

重定向浏览器。 默认重定向代码是 302（建立）。 通常， 你应尽量减少重定向， 除非永久移动一个页面， 这种情况应当使用代码 301（永久移动）。  

