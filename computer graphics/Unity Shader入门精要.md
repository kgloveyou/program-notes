# Unity Shader入门精要

勘误网址，http://candycat1992.github.io/unity_shaders_book/unity_shaders_book_corrigenda.html

配套资源，https://github.com/candycat1992/Unity_Shaders_Book

### 2.3.4 屏幕映射

​		有一个需要注意的地方是，屏幕坐标系在OpenGL和DirectX之间的差异问题。OpenGL把屏幕的左下角当成最小的窗口坐标值，而DirectX则定义了屏幕的左上角为最小的窗口坐标值。

<img src="Unity Shader入门精要.assets/image-20220816155740598.png" alt="image-20220816155740598" style="zoom: 50%;" />

​		产生这种差异的原因是，微软的窗口都使用了这样的坐标系统，因为这和我们的阅读方式是一致的：从左到右，从上到下，并且很多图像文件也是按照这样的格式存储的。

### 2.3.5　三角形设置

深度值（z坐标）

### 2.3.6　三角形遍历

​		三角形遍历（）阶段将会检查每个像素是否被一个三角网格所覆盖。如果被覆盖的话，就会生成一个片元（fragment）。

​		需要注意的是，一个片元并不是真正意义上的像素，而是包含了很多状态的集合，这些状态用于计算每个像素的最终颜色。这些状态包括了（但不限于）它的屏幕坐标、深度信息，以及其他从几何阶段输出的顶点信息，例如法线、纹理信息等。

### 2.3.7　片元着色器

​		**片元着色器（Fragement Shader）**。在DirectX中，片元着色器被称为**像素着色器（Pixel Shader）**,但片元着色器时一个更合适的名字，因为此时的片元并不是一个真正意义上的像素。

## 3.2　Unity Shader的基础：ShaderLab

​		Unity在背后会根据使用的平台来把这些结构编译成真正的代码和Shader文件，而开发者只需要和 Unity Shader 打交道即可。

## 3.6　答疑解惑

### 3.6.1　Unity Shader != 真正的Shader

### 3.6.2　Unity Shader和CG/HLSL之间的关系

### 3.6.3　我可以使用GLSL来写吗

### 3.6.3　我可以使用GLSL来写吗

## 3.7　扩展阅读

​		在Unity Shader中，绝大多数可编程管线的着色器代码是使用CG语言写的。

## 4.2　笛卡儿坐标系

**笛卡儿坐标系（Cartesian Coordinate System）**

### 4.2.4　Unity使用的坐标系

对于模型空间和世界空间，Unity使用的是左手系。

但对于观察空间来说，Unity使用的是右手坐标系。观察空间，通俗来讲就是以摄像机为原点的坐标系。

### 4.3.2　矢量运算

**矢量的点积**

**矢量的叉积**

- 正交矩阵

  另一个特殊的方阵是正交矩阵

### 4.4.5　行矩阵还是列矩阵



## 4.5　矩阵的几何意义：变换

### 4.5.1　什么是变换

**变换（transform）**

**仿射变换（affine transform）**就是合并线性变换和平移变换的变换类型。仿射变换可以使用一个4*4的矩阵来表示，为此，我们需要把矢量扩展到四维空间下，这就是**齐次坐标空间（homogeneous space）**。

### 4.5.2　齐次坐标

齐次坐标（homogeneous coordinate）

### 4.5.3　分解基础变换矩阵

### 4.5.4　平移矩阵

### 4.5.5　缩放矩阵

### 4.5.6　旋转矩阵

### 4.5.7　复合变换

我们可以把平移、旋转和缩放组合起来，来形成一个复杂的变换过程。

## 4.6　坐标空间　67

### 4.6.1　为什么要使用这么多不同的坐标空间　68

### 4.6.2　坐标空间的变换　68

### 4.6.3　顶点的坐标空间变换过程　72

### 4.6.4　模型空间　73

是和某个模型或者说是对象有关的。也被称为**对象空间（object space）**或**局部空间（local space）**。

模型空间的原点和坐标轴通常是由美术人员在建模软件中确定好的。模型顶点的坐标都是相对于模型空间的原点（通常位于模型的重心）定义的。

### 4.6.5　世界空间　73

**世界空间（world space）**

顶点变换的第一步，就是将顶点坐标从模型空间变换到世界空间中。这个变换通常叫做**模型变换（model transform）**。

### 4.6.6　观察空间　75

**观察空间（view space）**也被称为**摄像机空间（camera space）**。

观察空间中使用的是右手坐标系，这是符合OpenGL传统的。

从观察空间到屏幕空间的转换需要经过一个操作，那就是**投影（projection）**。

顶点变化的第二步，就是将顶点坐标从世界空间变换到观察空间中。这个变换叫做**观察变换（view transform）**。

### 4.6.7　裁剪空间　77



### 4.6.8　屏幕空间　83



### 4.6.9　总结　85

## 4.7　法线变换

## 4.9　答疑解惑　89

### 4.9.1　使用3×3还是4×4的

​		对于线性变换（例如旋转和缩放）来说，仅使用3*3的矩阵就足够表示所有的变换了。但如果存在平移变换，我们就需要使用4x4的矩阵。因此，在对顶点的变换中，我们通常使用4x4的变换矩阵。当然，在变换之前我们需要把点坐标转换成齐次坐标的表示，即把顶点的w分量设为1。而在对方向矢量的变换中，我们通常使用3x3的矩阵就足够了，这是因为平移变换对方向矢量是没有影响的。